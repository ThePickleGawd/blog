<!DOCTYPE html>
<html lang="en">
<head>

    <title>Detect Ping Pong Ball With Deep Learning</title>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <link rel="preload" as="style" href="/assets/built/screen.css?v=7eb339e29f" />
    <link rel="preload" as="script" href="/assets/built/casper.js?v=7eb339e29f" />

    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css?v=7eb339e29f" />

    <meta name="description" content="Tracking a ping pong ball with decent accuracy">
    <link rel="icon" href="https://blog.dylanlu.com/content/images/size/w256h256/2023/03/icon_ball.png" type="image/png">
    <link rel="canonical" href="https://blog.dylanlu.com/detect-ping-pong-ball-with-deep-learning/">
    <meta name="referrer" content="no-referrer-when-downgrade">
    
    <meta property="og:site_name" content="Dylan&#x27;s Dev Blog">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Detect Ping Pong Ball With Deep Learning">
    <meta property="og:description" content="Tracking a ping pong ball with decent accuracy">
    <meta property="og:url" content="https://blog.dylanlu.com/detect-ping-pong-ball-with-deep-learning/">
    <meta property="og:image" content="https://blog.dylanlu.com/content/images/2025/01/image-4.png">
    <meta property="article:published_time" content="2024-11-01T06:19:25.000Z">
    <meta property="article:modified_time" content="2025-01-16T08:14:31.000Z">
    <meta property="article:tag" content="Dev">
    
    <meta property="article:publisher" content="https://www.facebook.com/dylan.lu.982">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Detect Ping Pong Ball With Deep Learning">
    <meta name="twitter:description" content="Tracking a ping pong ball with decent accuracy">
    <meta name="twitter:url" content="https://blog.dylanlu.com/detect-ping-pong-ball-with-deep-learning/">
    <meta name="twitter:image" content="https://blog.dylanlu.com/content/images/2025/01/image-4.png">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Dylan Lu">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="Dev">
    <meta name="twitter:site" content="@ThePickleGawd">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="675">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Dylan&#x27;s Dev Blog",
        "url": "https://blog.dylanlu.com/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://blog.dylanlu.com/content/images/size/w256h256/2023/03/icon_ball.png",
            "width": 60,
            "height": 60
        }
    },
    "author": {
        "@type": "Person",
        "name": "Dylan Lu",
        "image": {
            "@type": "ImageObject",
            "url": "https://blog.dylanlu.com/content/images/2023/03/IMG_4955-2.jpg",
            "width": 1200,
            "height": 1258
        },
        "url": "https://blog.dylanlu.com/author/dylan/",
        "sameAs": [
            "https://dylanlu.com"
        ]
    },
    "headline": "Detect Ping Pong Ball With Deep Learning",
    "url": "https://blog.dylanlu.com/detect-ping-pong-ball-with-deep-learning/",
    "datePublished": "2024-11-01T06:19:25.000Z",
    "dateModified": "2025-01-16T08:14:31.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://blog.dylanlu.com/content/images/2025/01/image-4.png",
        "width": 1200,
        "height": 675
    },
    "keywords": "Dev",
    "description": "Tracking a ping pong ball with decent accuracy",
    "mainEntityOfPage": "https://blog.dylanlu.com/detect-ping-pong-ball-with-deep-learning/"
}
    </script>

    <meta name="generator" content="Ghost 5.85">
    <link rel="alternate" type="application/rss+xml" title="Dylan&#x27;s Dev Blog" href="https://blog.dylanlu.com/rss/">
    
    <script defer src="https://cdn.jsdelivr.net/ghost/sodo-search@~1.1/umd/sodo-search.min.js" data-key="95cadc1cc0652e4ace5a304046" data-styles="https://cdn.jsdelivr.net/ghost/sodo-search@~1.1/umd/main.css" data-sodo-search="https://blog.dylanlu.com/" crossorigin="anonymous"></script>
    
    <link href="https://blog.dylanlu.com/webmentions/receive/" rel="webmention">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-vsc-dark-plus.min.css" integrity="sha512-ML8rkwYTFNcblPFx+VLgFIT2boa6f8DDP6p6go4+FT0/mJ8DCbCgi6S0UdjtzB3hKCr1zhU+YVB0AHhIloZP8Q==" crossorigin="anonymous" referrerpolicy="no-referrer" />

<link rel="stylesheet" type="text/css" href="https://ghost.org/changelog/public/cards.min.js?v=d2955bb5c6">
<script defer="" src="https://ghost.org/changelog/public/cards.min.js?v=d2955bb5c6"></script>
<link rel="stylesheet" type="text/css" href="https://ghost.org/changelog/public/cards.min.css?v=db70eba112">
<script defer="" src="https://ghost.org/changelog/public/cards.min.css?v=db70eba112"></script>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-QDGM6S5BE1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-QDGM6S5BE1');
</script><style>:root {--ghost-accent-color: #252526;}</style>

</head>
<body class="post-template tag-dev is-head-left-logo has-sans-body has-cover">
<div class="viewport">

    <header id="gh-head" class="gh-head outer">
        <div class="gh-head-inner inner">
            <div class="gh-head-brand">
                <a class="gh-head-logo no-image" href="https://blog.dylanlu.com">
                        Dylan&#x27;s Dev Blog
                </a>
                <button class="gh-search gh-icon-btn" aria-label="Search this site" data-ghost-search><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></button>
                <button class="gh-burger" aria-label="Main Menu"></button>
            </div>

            <nav class="gh-head-menu">
                <ul class="nav">
    <li class="nav-about"><a href="https://blog.dylanlu.com/about/">About</a></li>
    <li class="nav-timeline"><a href="https://blog.dylanlu.com/timeline/">Timeline</a></li>
    <li class="nav-raps"><a href="https://blog.dylanlu.com/raps/">Raps</a></li>
</ul>

            </nav>

            <div class="gh-head-actions">
                        <button class="gh-search gh-icon-btn" aria-label="Search this site" data-ghost-search><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></button>
            </div>
        </div>
    </header>

    <div class="site-content">
        



<main id="site-main" class="site-main">
<article class="article post tag-dev ">

    <header class="article-header gh-canvas">

        <div class="article-tag post-card-tags">
                <span class="post-card-primary-tag">
                    <a href="/tag/dev/">Dev</a>
                </span>
        </div>

        <h1 class="article-title">Detect Ping Pong Ball With Deep Learning</h1>

            <p class="article-excerpt">Tracking a ping pong ball with decent accuracy</p>

        <div class="article-byline">
        <section class="article-byline-content">

            <ul class="author-list">
                <li class="author-list-item">
                    <a href="/author/dylan/" class="author-avatar" aria-label="Read more of Dylan Lu">
                        <img class="author-profile-image" src="/content/images/size/w100/2023/03/IMG_4955-2.jpg" alt="Dylan Lu" />
                    </a>
                </li>
            </ul>

            <div class="article-byline-meta">
                <h4 class="author-name"><a href="/author/dylan/">Dylan Lu</a></h4>
                <div class="byline-meta-content">
                    <time class="byline-meta-date" datetime="2024-10-31">Oct 31, 2024</time>
                        <span class="byline-reading-time"><span class="bull">&bull;</span> 3 min read</span>
                </div>
            </div>

        </section>
        </div>

            <figure class="article-image">
                <img
                    srcset="/content/images/size/w300/2025/01/image-4.png 300w,
                            /content/images/size/w600/2025/01/image-4.png 600w,
                            /content/images/size/w1000/2025/01/image-4.png 1000w,
                            /content/images/size/w2000/2025/01/image-4.png 2000w"
                    sizes="(min-width: 1400px) 1400px, 92vw"
                    src="/content/images/size/w2000/2025/01/image-4.png"
                    alt="Detect Ping Pong Ball With Deep Learning"
                />
            </figure>

    </header>

    <section class="gh-content gh-canvas">
        <p>Earlier I mentioned that the new direction of my project was to create a 3D reconstruction of a ping pong game using pose detection and ball tracking. My first step was to track the ball movement, and it looks like I did it (with decent accuracy)!</p><h2 id="yolo">YOLO</h2><p>You Only Look Once (YOLO) is a deep-learning architecture for object detection and tracking. The benefit of using this model over something like Fast R-CNN or other models is that it can run inference very fast (as the name implies, it only looks once).</p><p>I actually didn't realize that a whole auto referee system for ping pong was already created several years ago, as described in this paper: <a href="https://arxiv.org/pdf/2004.09927?ref=localhost">https://arxiv.org/pdf/2004.09927</a>. Those guys, however, use a two-step system to detect the ball; I want to do it faster so that we can run the app on a smart phone.</p><p>YOLO is currently in V11. The python library makes it really easy to use as well, since I only need to specify my dataset directory and it will take care of the rest.</p><pre><code class="language-Python">model = YOLO("yolo11n.pt")
results = model.train(
    data="../dataset/opentt.yaml", 
    project="..", 
    epochs=300, 
    patience=10, 
    batch=-1, 
    imgsz=640
)</code></pre><p>The harder part was getting good data, but luckily the authors of the paper I mentioned above made their dataset open source. All I needed was a nice conversation with ChatGPT and we had could pull frames and annotations from the video!</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.dylanlu.com/content/images/2024/11/image.png" class="kg-image" alt="" loading="lazy" width="258" height="467"><figcaption><span style="white-space: pre-wrap;">There's like 10,000 of these images</span></figcaption></figure><p>You can look at the rest of the code, which I'm pretty proud of. This is actually my first deep learning project where I wrote my own code to train a model (even though I used YOLO).</p><figure class="kg-card kg-bookmark-card"><a class="kg-bookmark-container" href="https://github.com/ccs-cs1l-f24/ping-pong-deep-learning?ref=localhost"><div class="kg-bookmark-content"><div class="kg-bookmark-title">GitHub - ccs-cs1l-f24/ping-pong-deep-learning</div><div class="kg-bookmark-description">Contribute to ccs-cs1l-f24/ping-pong-deep-learning development by creating an account on GitHub.</div><div class="kg-bookmark-metadata"><img class="kg-bookmark-icon" src="https://github.githubassets.com/assets/pinned-octocat-093da3e6fa40.svg" alt=""><span class="kg-bookmark-author">GitHub</span><span class="kg-bookmark-publisher">ccs-cs1l-f24</span></div></div><div class="kg-bookmark-thumbnail"><img src="https://opengraph.githubassets.com/d3e15703cc89dd60a410f198b4458375753b25fc36f36a1eba7ce56fd68fc990/ccs-cs1l-f24/ping-pong-deep-learning" alt=""></div></a></figure><h2 id="results">Results</h2><p>After 4.5 hours of training on my RTX 3070 Ti, I thought it was all a waste because the loss was really high and it automatically stopped at 46 epochs. Even worse, I tried testing with an image I took a while ago with James and it didn't work! But I figured out it was because the ball in that image was orange when I trained on only white balls.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.dylanlu.com/content/images/2024/11/image-3.png" class="kg-image" alt="" loading="lazy" width="2000" height="923" srcset="https://blog.dylanlu.com/content/images/size/w600/2024/11/image-3.png 600w, https://blog.dylanlu.com/content/images/size/w1000/2024/11/image-3.png 1000w, https://blog.dylanlu.com/content/images/size/w1600/2024/11/image-3.png 1600w, https://blog.dylanlu.com/content/images/2024/11/image-3.png 2000w" sizes="(min-width: 720px) 720px"><figcaption><span style="white-space: pre-wrap;">No ball detected ðŸ˜¦</span></figcaption></figure><p>But the confusion matrix seems kind of promising. Looks like it can detect the ball about 80% of the time, which is not bad for my first model.</p><figure class="kg-card kg-image-card"><img src="https://blog.dylanlu.com/content/images/2024/11/image-2.png" class="kg-image" alt="" loading="lazy" width="2000" height="1500" srcset="https://blog.dylanlu.com/content/images/size/w600/2024/11/image-2.png 600w, https://blog.dylanlu.com/content/images/size/w1000/2024/11/image-2.png 1000w, https://blog.dylanlu.com/content/images/size/w1600/2024/11/image-2.png 1600w, https://blog.dylanlu.com/content/images/2024/11/image-2.png 2000w" sizes="(min-width: 720px) 720px"></figure><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.dylanlu.com/content/images/2024/11/image-4.png" class="kg-image" alt="" loading="lazy" width="1920" height="1080" srcset="https://blog.dylanlu.com/content/images/size/w600/2024/11/image-4.png 600w, https://blog.dylanlu.com/content/images/size/w1000/2024/11/image-4.png 1000w, https://blog.dylanlu.com/content/images/size/w1600/2024/11/image-4.png 1600w, https://blog.dylanlu.com/content/images/2024/11/image-4.png 1920w" sizes="(min-width: 720px) 720px"><figcaption><span style="white-space: pre-wrap;">Running inference on test image</span></figcaption></figure><h2 id="conclusion">Conclusion</h2><p>Yay, I made some good progress. My next step is to input a video and see whether it can consistently track the ball throughout each frame (and how fast). Then, I'll need to track the table and the people. So yeah I'd probably need to retrain my model for another 5 hours with more data ðŸ˜­</p>
    </section>


</article>
</main>




            <aside class="read-more-wrap outer">
                <div class="read-more inner">
                        
<article class="post-card post">

    <a class="post-card-image-link" href="/freshman-year/">

        <img class="post-card-image"
            srcset="/content/images/size/w300/2025/06/cover2.jpg 300w,
                    /content/images/size/w600/2025/06/cover2.jpg 600w,
                    /content/images/size/w1000/2025/06/cover2.jpg 1000w,
                    /content/images/size/w2000/2025/06/cover2.jpg 2000w"
            sizes="(max-width: 1000px) 400px, 800px"
            src="/content/images/size/w600/2025/06/cover2.jpg"
            alt="Freshman Year is Over! This is Everything I Did and Learned."
            loading="lazy"
        />


    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="/freshman-year/">
            <header class="post-card-header">
                <div class="post-card-tags">
                </div>
                <h2 class="post-card-title">
                    Freshman Year is Over! This is Everything I Did and Learned.
                </h2>
            </header>
                <div class="post-card-excerpt">I finished my first year at UCSB, making new friends and learning so much about CS/ML.</div>
        </a>

        <footer class="post-card-meta">
            <time class="post-card-meta-date" datetime="2025-06-20">Jun 20, 2025</time>
                <span class="post-card-meta-length">10 min read</span>
        </footer>

    </div>

</article>
                        
<article class="post-card post">

    <a class="post-card-image-link" href="/spring-break-2025/">

        <img class="post-card-image"
            srcset="/content/images/size/w300/2025/03/CE28C217-E6D6-4C32-B04B-D1F09185C94B.png 300w,
                    /content/images/size/w600/2025/03/CE28C217-E6D6-4C32-B04B-D1F09185C94B.png 600w,
                    /content/images/size/w1000/2025/03/CE28C217-E6D6-4C32-B04B-D1F09185C94B.png 1000w,
                    /content/images/size/w2000/2025/03/CE28C217-E6D6-4C32-B04B-D1F09185C94B.png 2000w"
            sizes="(max-width: 1000px) 400px, 800px"
            src="/content/images/size/w600/2025/03/CE28C217-E6D6-4C32-B04B-D1F09185C94B.png"
            alt="Spring Break 2025 - Hawaii"
            loading="lazy"
        />


    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="/spring-break-2025/">
            <header class="post-card-header">
                <div class="post-card-tags">
                </div>
                <h2 class="post-card-title">
                    Spring Break 2025 - Hawaii
                </h2>
            </header>
                <div class="post-card-excerpt">We went to Hawaii for a few days and ate lots of food.</div>
        </a>

        <footer class="post-card-meta">
            <time class="post-card-meta-date" datetime="2025-04-02">Apr 2, 2025</time>
                <span class="post-card-meta-length">5 min read</span>
        </footer>

    </div>

</article>
                        
<article class="post-card post">

    <a class="post-card-image-link" href="/run-from-duo/">

        <img class="post-card-image"
            srcset="/content/images/size/w300/2025/03/thumbnail.png 300w,
                    /content/images/size/w600/2025/03/thumbnail.png 600w,
                    /content/images/size/w1000/2025/03/thumbnail.png 1000w,
                    /content/images/size/w2000/2025/03/thumbnail.png 2000w"
            sizes="(max-width: 1000px) 400px, 800px"
            src="/content/images/size/w600/2025/03/thumbnail.png"
            alt="VR Chinese Learning with Speaking and Zombies"
            loading="lazy"
        />


    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="/run-from-duo/">
            <header class="post-card-header">
                <div class="post-card-tags">
                </div>
                <h2 class="post-card-title">
                    VR Chinese Learning with Speaking and Zombies
                </h2>
            </header>
                <div class="post-card-excerpt">My CCS 1L Winter 2025 Project. A VR game to learn Chinese, except it&#39;s in a zombie survival game. Convince Duolingo to give you weapons by speaking in Chinese.</div>
        </a>

        <footer class="post-card-meta">
            <time class="post-card-meta-date" datetime="2025-03-14">Mar 14, 2025</time>
                <span class="post-card-meta-length">4 min read</span>
        </footer>

    </div>

</article>
                </div>
            </aside>



    </div>

    <footer class="site-footer outer">
        <div class="inner">
            <section class="copyright"><a href="https://blog.dylanlu.com">Dylan&#x27;s Dev Blog</a> &copy; 2025</section>
            <nav class="site-footer-nav">
                
            </nav>
            <div class="gh-powered-by"><a href="https://ghost.org/" target="_blank" rel="noopener">Powered by Ghost</a></div>
        </div>
    </footer>

</div>

    <div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="pswp__bg"></div>

    <div class="pswp__scroll-wrap">
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>
<script
    src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
    crossorigin="anonymous">
</script>
<script src="/assets/built/casper.js?v=7eb339e29f"></script>
<script>
$(document).ready(function () {
    // Mobile Menu Trigger
    $('.gh-burger').click(function () {
        $('body').toggleClass('gh-head-open');
    });
    // FitVids - Makes video embeds responsive
    $(".gh-content").fitVids();
});
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/components/prism-core.min.js" integrity="sha512-9khQRAUBYEJDCDVP2yw3LRUQvjJ0Pjx0EShmaQjcHa6AXiOv6qHQu9lCAIR8O+/D8FtaCoJ2c0Tf9Xo7hYH01Q==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/plugins/autoloader/prism-autoloader.min.js" integrity="sha512-fTl/qcO1VgvKtOMApX2PdZzkziyr2stM65GYPLGuYMnuMm1z2JLJG6XVU7C/mR+E7xBUqCivykuhlzfqxXBXbg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

</body>
</html>
